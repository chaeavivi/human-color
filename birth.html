<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>휴먼컬러 결과지 (정밀 만세력 수정판)</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        /* 기존 스타일 유지 + 수정 기능 스타일 추가 */
        :root { --bg-color: #f5f5f5; --label-bg: #f2f2f2; }
        body { font-family: 'Noto Sans KR', sans-serif; background-color: var(--bg-color); margin: 0; padding: 20px; color: #333; }
        
        .control-panel { max-width: 800px; margin: 0 auto 30px auto; background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .control-panel h1 { font-size: 24px; text-align: center; margin-bottom: 20px; }
        
        .input-group { display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap;}
        .input-box { flex: 1; min-width: 150px; }
        .input-box label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 14px; }
        .input-box input, .input-box select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        
        /* 간지 수동 수정 영역 */
        .manual-ganji { background: #fff3cd; padding: 15px; border-radius: 5px; margin-bottom: 15px; border: 1px solid #ffeeba; }
        .manual-ganji h4 { margin: 0 0 10px 0; font-size: 14px; color: #856404; }
        .ganji-row { display: flex; gap: 10px; justify-content: space-between; }
        .ganji-box { flex: 1; text-align: center; }
        .ganji-box span { display: block; font-size: 12px; margin-bottom: 3px; color: #666; }
        .ganji-select { width: 100%; padding: 5px; }

        .btn-row { display: flex; gap: 10px; margin-top: 20px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-calc { background-color: #4a90e2; color: white; }
        .btn-down { background-color: #333; color: white; }

        /* 결과지 스타일 (A4) */
        .report-container { width: 210mm; min-height: 297mm; background: white; margin: 0 auto; padding: 40px 50px; box-sizing: border-box; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        .header { display: flex; justify-content: space-between; border-bottom: 2px solid #333; padding-bottom: 15px; margin-bottom: 30px; align-items: flex-end;}
        .user-title { font-size: 26px; font-weight: 700; }
        .report-meta { text-align: right; }
        
        .attr-section { display: flex; margin-bottom: 30px; border-bottom: 1px solid #eee; padding-bottom: 20px; }
        .attr-code-box { width: 80px; height: 80px; background: var(--label-bg); display: flex; align-items: center; justify-content: center; font-size: 28px; font-weight: 800; margin-right: 20px; border-radius: 4px; }
        .attr-desc { flex: 1; font-size: 13px; line-height: 1.6; white-space: pre-line; display: flex; align-items: center; }

        .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 40px; }
        .sum-card { background: #fafafa; border: 1px solid #eee; padding: 15px; border-radius: 4px; }
        .sum-title { font-size: 12px; color: #888; margin-bottom: 5px; font-weight: bold; }
        .sum-val { font-size: 15px; font-weight: bold; margin-bottom: 8px; }
        .sum-desc { font-size: 11px; color: #666; line-height: 1.4; white-space: pre-line; }

        .main-section { display: flex; flex-direction: column; gap: 20px; }
        .section-row { display: flex; border: 1px solid #e0e0e0; height: 180px; }
        .section-label { width: 15%; background: var(--label-bg); display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; border-right: 1px solid #e0e0e0; }
        .lbl-order { font-size: 12px; color: #666; margin-bottom: 5px; }
        .lbl-main { font-size: 18px; font-weight: 800; }
        .section-content { width: 85%; padding: 20px; }
        .color-header { display: flex; align-items: center; margin-bottom: 12px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px; }
        .color-name { font-size: 20px; font-weight: 800; margin-right: 20px; }
        .color-keywords { font-size: 13px; color: #666; }
        .color-desc { font-size: 13px; line-height: 1.5; color: #444; white-space: pre-line; }

        .hide-on-pdf { }
    </style>
</head>
<body>

    <div class="control-panel hide-on-pdf">
        <h1>휴먼컬러 분석기 (정밀형)</h1>
        
        <div class="input-group">
            <div class="input-box">
                <label>이름</label>
                <input type="text" id="inpName" placeholder="예: 홍길동">
            </div>
            <div class="input-box">
                <label>생년월일 (양력)</label>
                <input type="date" id="inpDate">
            </div>
            <div class="input-box">
                <label>태어난 시간</label>
                <input type="time" id="inpTime">
            </div>
             <div class="input-box">
                <label>속성</label>
                <select id="inpAttr">
                    <option value="W-">W- (수음/조용한)</option>
                    <option value="W+">W+ (수양/자유로운)</option>
                    <option value="T+">T+ (목양/정직한)</option>
                    <option value="T-">T- (목음/유순한)</option>
                    <option value="F+">F+ (화양/낙천적인)</option>
                    <option value="F-">F- (화음/섬세한)</option>
                    <option value="E+">E+ (토양/느긋한)</option>
                    <option value="E-">E- (토음/서민적인)</option>
                    <option value="M+">M+ (금양/다부진)</option>
                    <option value="M-">M- (금음/아름다운)</option>
                </select>
            </div>
        </div>

        <button class="btn-calc" onclick="calculateSajuBase()" style="margin-bottom: 15px; background: #666;">▼ 1단계: 만세력 자동 계산</button>

        <div class="manual-ganji">
            <h4>※ 계산된 사주가 맞는지 확인하세요 (안 맞으면 변경 가능)</h4>
            <div class="ganji-row">
                <div class="ganji-box">
                    <span>3. 년주 (목표)</span>
                    <select id="selYearGan" class="ganji-select"></select>
                    <select id="selYearJi" class="ganji-select"></select>
                </div>
                <div class="ganji-box">
                    <span>2. 월주 (후천)</span>
                    <select id="selMonthGan" class="ganji-select"></select>
                    <select id="selMonthJi" class="ganji-select"></select>
                </div>
                <div class="ganji-box" style="border: 2px solid #ff5f00; border-radius:5px; padding:2px; background:white;">
                    <span style="font-weight:bold; color:#ff5f00;">1. 일주 (선천/핵심)</span>
                    <select id="selDayGan" class="ganji-select"></select>
                    <select id="selDayJi" class="ganji-select"></select>
                </div>
                <div class="ganji-box">
                    <span>4. 시주 (노하우)</span>
                    <select id="selHourGan" class="ganji-select"></select>
                    <select id="selHourJi" class="ganji-select"></select>
                </div>
            </div>
        </div>

        <div class="btn-row">
            <button class="btn-calc" onclick="applyAndRender()">▼ 2단계: 결과지 생성</button>
            <button class="btn-down" onclick="downloadPDF()">PDF 다운로드</button>
        </div>
    </div>

    <div id="reportArea" class="report-container">
        <div class="header">
            <div class="user-info">
                <div class="user-title" id="outName">홍길동 1990.01.01</div>
            </div>
            <div class="report-meta">
                <h3>휴먼컬러 분석</h3>
                <div id="outDate"></div>
            </div>
        </div>

        <div class="attr-section">
            <div class="attr-code-box" id="outAttrCode">W-</div>
            <div class="attr-desc" id="outAttrDesc"></div>
        </div>

        <div class="summary-grid">
            <div class="sum-card"><div class="sum-title">1st 선천/사고</div><div class="sum-val" id="sum1_val">-</div><div class="sum-desc" id="sum1_desc"></div></div>
            <div class="sum-card"><div class="sum-title">2nd 후천/행동</div><div class="sum-val" id="sum2_val">-</div><div class="sum-desc" id="sum2_desc"></div></div>
            <div class="sum-card"><div class="sum-title">3rd 목표/바람</div><div class="sum-val" id="sum3_val">-</div><div class="sum-desc" id="sum3_desc"></div></div>
            <div class="sum-card"><div class="sum-title">4th 노하우/방향</div><div class="sum-val" id="sum4_val">-</div><div class="sum-desc" id="sum4_desc"></div></div>
        </div>

        <div class="main-section">
            <div class="section-row">
                <div class="section-label"><span class="lbl-order">1st 선천</span><span class="lbl-main">사고</span></div>
                <div class="section-content">
                    <div class="color-header"><span class="color-name" id="main1_color"></span><span class="color-keywords" id="main1_key"></span></div>
                    <div class="color-desc" id="main1_text"></div>
                </div>
            </div>
            <div class="section-row">
                <div class="section-label"><span class="lbl-order">2nd 후천</span><span class="lbl-main">행동</span></div>
                <div class="section-content">
                    <div class="color-header"><span class="color-name" id="main2_color"></span><span class="color-keywords" id="main2_key"></span></div>
                    <div class="color-desc" id="main2_text"></div>
                </div>
            </div>
            <div class="section-row">
                <div class="section-label"><span class="lbl-order">3rd 목표</span><span class="lbl-main">바람</span></div>
                <div class="section-content">
                    <div class="color-header"><span class="color-name" id="main3_color"></span><span class="color-keywords" id="main3_key"></span></div>
                    <div class="color-desc" id="main3_text"></div>
                </div>
            </div>
            <div class="section-row">
                <div class="section-label"><span class="lbl-order">4th 노하우</span><span class="lbl-main">방향</span></div>
                <div class="section-content">
                    <div class="color-header"><span class="color-name" id="main4_color"></span><span class="color-keywords" id="main4_key"></span></div>
                    <div class="color-desc" id="main4_text"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 데이터베이스 ---
        const humanColorData = {
            1: { color: "MAGENTA", keyword: "대지", title: "대지, 포용력, 수용", desc: "+ 큰 마음으로 다른 것들을 받아들일 수 있는 힘이 있습니다.\n+ 자신만의 영역을 키워가는 성향이며, 깔끔함을 선호합니다.\n+ 리더십이 있고, 강한 정신력을 갖고 있습니다.", desc_detail: "+넓은 마음으로 소중하게 여기는 다른 사람을 이해하고 수용합니다.\n+침착하고 사람을 안정적으로 이끄는 리더타입입니다." },
            2: { color: "RED", keyword: "태양", title: "행동력, 태양, 열정", desc: "+ 행동으로 결과를 만들어내는 사람입니다. 일단 부딪혀 봅니다.\n+ 책임감이 강하고 현실적응력이 남달라 리더 기질을 발휘합니다.\n+ 주의 : 과로, 워커홀릭", desc_detail: "+목적을 갖고 움직이는 힘과 열정으로 가득 차 있어 적극적으로 대응합니다." },
            3: { color: "ORANGE", keyword: "바람", title: "바람, 표현, 즐거움", desc: "+ 목표를 달성하는 일이 곧 기쁨이자 즐거움이 됩니다.\n+ 행동이 빠르고 일처리가 빠른 사람입니다.\n+ 칭찬을 좋아하며 호기심 가득합니다.", desc_detail: "+외유내강으로 겉은 부드러우나 속은 단단합니다.\n+감정을 밖으로 표출하는 힘과 즐겁게 사는 것을 중요하게 여깁니다." },
            4: { color: "RED ORANGE", keyword: "과실나무", title: "개혁, 도전, 야망", desc: "+ 현실 안주란 없습니다. 더 나은 미래를 생각합니다.\n+ 에너지를 응축한 뒤 폭발해 내는 것이 특징입니다.\n+ 칠전팔기 야망가입니다.", desc_detail: "+강한 에너지와 추진력을 가지며 목표를 향해 나아갑니다.\n+새롭게 변화시키고자 하는 도전의식이 강합니다." },
            5: { color: "YELLOW", keyword: "하늘", title: "하늘, 선견력, 희망", desc: "+ 호기심이 왕성하며 배움에 대한 마음이 큽니다.\n+ 남들보다 앞서가는 선구자형이며 긍정적입니다.\n+ 주의 : 세상 물정을 잘 모를 수 있음", desc_detail: "+자신의 생각과 감정을 솔직하게 표현하며 주변에 긍정적 영향을 줍니다.\n+앞을 내다보는 힘을 갖고 있으며 늘 밝고 명랑합니다." },
            6: { color: "YELLOW GREEN", keyword: "아기", title: "꽃, 관찰, 평화", desc: "+ 사람 중심으로 사고하며 상냥하고 온화합니다.\n+ 주의 깊고 세심하게 관찰하는 힘을 갖고 있습니다.\n+ 애정이 풍부하며 평화를 유지하려 합니다.", desc_detail: "+다른 사람들을 수용하고 포용하는 큰 그릇을 가졌습니다.\n+매사에 주의깊고 유심히 보는 힘이 있으며 친절합니다." },
            7: { color: "GREEN", keyword: "숲", title: "안정력, 숲, 평화", desc: "+ 원리와 원칙에 기반하여 목표를 달성하고자 합니다.\n+ 사람 중심 성향으로 평화롭고 중립적입니다.\n+ 주변에 사람들이 모여드는 특성이 있습니다.", desc_detail: "+순수하고 진실된 마음을 갖고 있으며 맡은 일에 최선을 다합니다.\n+상황을 차분하게 이끌며 평화를 사랑합니다." },
            8: { color: "TURQUOISE", keyword: "샘", title: "샘, 독립적, 통찰", desc: "+ 자신에 대한 통찰이 깊고 자기 영역이 확고합니다.\n+ 무에서 유를 창조하는 기획성이 남다릅니다.\n+ 독립적, 독창적이며 혼자서 잘 하는 사람입니다.", desc_detail: "+뛰어난 통찰력과 지적인 모습으로 상황을 빠르게 파악합니다.\n+자유분방하고 독립적인 사고를 하는 노력형 천재 타입입니다." },
            9: { color: "BLUE GREEN", keyword: "지구", title: "지구, 균형, 신념", desc: "+ 균형을 추구하며 나의 평화가 우선입니다.\n+ 자신의 세계와 공간이 반드시 있어야 하는 사람입니다.\n+ 메타인지가 발달하여 객관적입니다.", desc_detail: "+세부 사항에 주의를 기울이며 정교하고 정확하게 접근합니다.\n+균형을 유지하는 힘으로 삶의 평화와 워라밸을 중시합니다." },
            10: { color: "BLUE", keyword: "달", title: "커뮤니케이션, 신뢰", desc: "+ 사람에 대한 유연성이 있고 책임감이 강합니다.\n+ 신뢰나 유대감을 소중히 여기며 전달 능력이 우수합니다.\n+ 거짓을 간파할 수 있습니다.", desc_detail: "+창의적이고 예술적인 성향과 감수성을 갖고 있습니다.\n+언어, 커뮤니케이션 능력이 탁월하며 성실한 사람입니다." },
            11: { color: "INDIGO", keyword: "바다", title: "이해력, 바다, 논리", desc: "+ 깊은 사고를 하고 내면을 들여다보는 힘이 있습니다.\n+ 냉정하게 판단하고 처리하는 능력이 탁월합니다.\n+ 불굴의 정신력으로 재물을 축적합니다.", desc_detail: "+문제를 해결하는 데 있어 논리적이고 체계적입니다.\n+전체를 파악하고 냉정하게 판단해 처리하는 능력을 갖췄습니다." },
            12: { color: "PURPLE", keyword: "우주", title: "우주, 직관, 감성", desc: "+ 자신만의 이상이 있고 자유로움을 추구합니다.\n+ 직관이 발달하여 무의식적으로 결과를 만들어냅니다.\n+ 정신적인 것, 예술, 미적 감각이 탁월합니다.", desc_detail: "+일반적인 사고에 영향을 받지 않으며 직감적입니다.\n+변화와 안정감을 둘 다 추구하는 신비로운 매력이 있습니다." }
        };

        const attributeData = {
            "W-": { desc: "+논리적이고 체계적인 방법을 사용합니다. 깊은 사고를 합니다." },
            "W+": { desc: "+창의적이고 예술적인 성향과 직관적인 판단력이 있습니다." },
            "T+": { desc: "+행동으로 결과를 만들어냅니다. 열정이 가득합니다." },
            "T-": { desc: "+외유내강형입니다. 겉은 부드러우나 속은 단단합니다." },
            "F+": { desc: "+강한 에너지와 추진력으로 목표를 향해 나아갑니다." },
            "F-": { desc: "+섬세하며 타인의 감정을 잘 이해하고 배려합니다." },
            "E+": { desc: "+큰 그릇으로 타인을 수용하고 포용합니다." },
            "E-": { desc: "+순수하고 진실된 마음으로 맡은 일에 최선을 다합니다." },
            "M+": { desc: "+뛰어난 통찰력으로 상황을 빠르게 파악합니다." },
            "M-": { desc: "+세부 사항에 주의를 기울이며 정교하게 접근합니다." }
        };

        const colorHexMap = { "MAGENTA": "#D1357A", "RED": "#E60012", "ORANGE": "#F39800", "RED ORANGE": "#FF5F00", "YELLOW": "#FFD200", "YELLOW GREEN": "#9EBD25", "GREEN": "#009944", "TURQUOISE": "#00A0E9", "BLUE GREEN": "#0068B7", "BLUE": "#1D419B", "INDIGO": "#271E6E", "PURPLE": "#753B92" };
        const woonsungToColorNum = { "제왕": 1, "사": 2, "장생": 3, "목욕": 4, "관대": 5, "양": 6, "묘": 7, "태": 8, "병": 9, "쇠": 10, "건록": 11, "절": 12 };

        // --- 정밀 만세력 엔진 (Julian Day Based) ---
        const Cheongan = ["갑", "을", "병", "정", "무", "기", "경", "신", "임", "계"];
        const Jiji = ["자", "축", "인", "묘", "진", "사", "오", "미", "신", "유", "술", "해"];

        // Select 박스 초기화
        window.onload = function() {
            const selects = document.querySelectorAll('.ganji-select');
            selects.forEach(sel => {
                const isGan = sel.id.includes('Gan');
                const arr = isGan ? Cheongan : Jiji;
                arr.forEach((item, idx) => {
                    const opt = document.createElement('option');
                    opt.value = idx;
                    opt.text = item;
                    sel.add(opt);
                });
            });
            
            // 오늘 날짜 세팅
            const today = new Date();
            document.getElementById('outDate').innerText = today.toISOString().split('T')[0];
        };

        // 줄리안 데이 계산 (날짜 오차 최소화)
        function getJulianFromUnix(time) {
            return (time / 86400000) + 2440587.5;
        }

        // 절기 대략 계산 (양력 기준) - 100% 정확하려면 DB 필요하지만, 4~8일 사이 보정 적용
        function getSolarTermDay(year, month) {
            // 대략적인 절기 일자 (입춘, 경칩 등)
            const termDates = [6, 4, 6, 5, 6, 6, 7, 8, 8, 8, 8, 7]; // 1월~12월 소한, 입춘... 근사치
            return termDates[month-1];
        }

        function calculateSajuBase() {
            const name = document.getElementById('inpName').value;
            const dateStr = document.getElementById('inpDate').value;
            const timeStr = document.getElementById('inpTime').value;

            if(!dateStr) { alert("생년월일을 입력해주세요."); return; }

            const dateObj = new Date(dateStr);
            const year = dateObj.getFullYear();
            const month = dateObj.getMonth() + 1;
            const day = dateObj.getDate();
            let hour = 12;
            if (timeStr) hour = parseInt(timeStr.split(':')[0]);

            // 1. 일주 (Day Pillar) - 줄리안 데이 이용 (정확도 높음)
            // 기준: 1900년 1월 1일 UTC = Julian 2415020.5 (갑술일 10번)
            // 한국시간 보정 필요 (KST = UTC+9)
            // 간단식: 1900.1.1은 갑술일.
            const baseDate = new Date(1900, 0, 1);
            const targetDate = new Date(year, month - 1, day);
            const diffTime = targetDate.getTime() - baseDate.getTime();
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            
            // 60갑자 인덱스
            let dayIndex = (diffDays + 10) % 60; // 1900.1.1은 10번째(갑술)
            if (dayIndex < 0) dayIndex += 60;
            
            const dayGanIdx = dayIndex % 10;
            const dayJiIdx = dayIndex % 12;

            // 2. 월주 (Month Pillar) - 절기 기준 보정
            const termDay = getSolarTermDay(year, month);
            let sajuMonth = month;
            if (day < termDay) sajuMonth = month - 1;
            if (sajuMonth === 0) sajuMonth = 12;

            // 월건 계산법 (년간에 따라 결정)
            // 갑기년 -> 병인두, 을경년 -> 무인두... 
            // 복잡하므로 여기선 지지(Month Branch)만 정확히 잡음 (인=2월)
            // 인:2, 묘:3 ... 자:12(0), 축:1
            const monthMap = { 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10, 11:11, 12:0, 1:1 };
            const monthJiIdx = monthMap[sajuMonth];
            
            // 월간은 년간에 의해 자동 결정되나 12운성에는 '월지'가 중요하므로 월간은 기본값(임의) 또는 계산
            // (월간 계산 공식: (년간idx % 5) * 2 + 2 + (월지idx - 2)) % 10... 생략, UI에서 선택 유도)
            const monthGanIdx = 0; // 임시

            // 3. 년주 (Year Pillar) - 입춘(2월 4일경) 기준
            let sajuYear = year;
            if (month < 2 || (month === 2 && day < 4)) sajuYear--;
            
            // 1984 = 갑자(0)
            const yearGanIdx = (sajuYear - 1984 + 10000) % 10; // +10000은 음수 방지
            const yearJiIdx = (sajuYear - 1984 + 10000) % 12;

            // 4. 시주 (Hour Pillar)
            let hourJiIdx = 0;
            if (hour >= 23 || hour < 1) hourJiIdx = 0; // 자
            else hourJiIdx = Math.floor((hour + 1) / 2) % 12;
            const hourGanIdx = 0; // 임시

            // UI에 반영 (사용자가 볼 수 있게)
            setSelectValue('selYearGan', yearGanIdx);
            setSelectValue('selYearJi', yearJiIdx);
            setSelectValue('selMonthGan', monthGanIdx); // 월간은 정확지 않음(자동계산 복잡)
            setSelectValue('selMonthJi', monthJiIdx);
            setSelectValue('selDayGan', dayGanIdx);
            setSelectValue('selDayJi', dayJiIdx);
            setSelectValue('selHourGan', hourGanIdx);
            setSelectValue('selHourJi', hourJiIdx);

            alert("1차 계산 완료. \n화면 중앙의 [노란 박스] 안의 간지가 맞는지 확인해주세요.\n(특히 일주가 중요합니다!)");
        }

        function setSelectValue(id, val) {
            const el = document.getElementById(id);
            if(el) el.value = val;
        }

        // --- 12운성 및 결과 도출 ---
        function get12Woonsung(ganIdx, jiIdx) {
            // 장생 시작 지지 인덱스
            // 갑(0):해(11), 을(1):오(6), 병(2):인(2), 정(3):유(9), 무(4):인(2)
            // 기(5):유(9), 경(6):사(5), 신(7):자(0), 임(8):신(8), 계(9):묘(3)
            const starts = [11, 6, 2, 9, 2, 9, 5, 0, 8, 3];
            const isYang = [0, 2, 4, 6, 8].includes(parseInt(ganIdx)); // 갑병무경임
            const startJi = starts[ganIdx];
            
            const WoonsungOrder = ["장생", "목욕", "관대", "건록", "제왕", "쇠", "병", "사", "묘", "절", "태", "양"];
            
            let idx;
            if (isYang) { // 순행
                idx = (jiIdx - startJi + 12) % 12;
            } else { // 역행
                idx = (startJi - jiIdx + 12) % 12;
            }
            return WoonsungOrder[idx];
        }

        function applyAndRender() {
            const name = document.getElementById('inpName').value;
            const dateStr = document.getElementById('inpDate').value;
            const attr = document.getElementById('inpAttr').value;

            if(!name) { alert("이름을 입력하세요."); return; }

            // 사용자가 선택/수정한 간지 값을 가져옴 (일간 기준)
            const myGan = parseInt(document.getElementById('selDayGan').value); // 일간 (기준)
            
            const dayJi = parseInt(document.getElementById('selDayJi').value);   // 1. 일지 (선천)
            const monthJi = parseInt(document.getElementById('selMonthJi').value); // 2. 월지 (후천)
            const yearJi = parseInt(document.getElementById('selYearJi').value);   // 3. 년지 (목표)
            const hourJi = parseInt(document.getElementById('selHourJi').value);   // 4. 시지 (노하우)

            // 12운성 계산
            const w1 = get12Woonsung(myGan, dayJi);
            const w2 = get12Woonsung(myGan, monthJi);
            const w3 = get12Woonsung(myGan, yearJi);
            const w4 = get12Woonsung(myGan, hourJi);

            // 컬러 매핑
            renderSection(1, woonsungToColorNum[w1]);
            renderSection(2, woonsungToColorNum[w2]);
            renderSection(3, woonsungToColorNum[w3]);
            renderSection(4, woonsungToColorNum[w4]);

            // 기본 정보 렌더링
            document.getElementById('outName').innerText = `${name} ${dateStr}`;
            document.getElementById('outAttrCode').innerText = attr;
            if(attributeData[attr]) document.getElementById('outAttrDesc').innerText = attributeData[attr].desc;

            // 스크롤 이동
            document.getElementById('reportArea').scrollIntoView({behavior: "smooth"});
        }

        function renderSection(idx, num) {
            const data = humanColorData[num];
            if(!data) return;
            
            // 요약부
            document.getElementById(`sum${idx}_val`).innerText = data.keyword;
            document.getElementById(`sum${idx}_desc`).innerText = data.desc_detail;
            
            // 메인부
            const colEl = document.getElementById(`main${idx}_color`);
            colEl.innerText = data.color;
            colEl.style.color = colorHexMap[data.color];
            document.getElementById(`main${idx}_key`).innerText = data.title;
            document.getElementById(`main${idx}_text`).innerText = data.desc;
        }

        function downloadPDF() {
            const el = document.getElementById('reportArea');
            const name = document.getElementById('inpName').value || "결과";
            html2pdf().from(el).set({
                margin: 0,
                filename: `${name}_휴먼컬러.pdf`,
                image: { type: 'jpeg', quality: 1 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            }).save();
        }
    </script>
</body>
</html>
